aggregate:
    count id
    count product_name as purchased
    sum product_price as total_spent with product_name

for row in rows:
    tally(row['product_name'])
