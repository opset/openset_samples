aggregate:
    count id
    count product_name as purchased
    sum product_price as total_spent

for row in rows if
        'retro' in product_tags:

    for tag in product_tags:
        tally(row['product_name'], tag)
